(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73],{5410:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/BankAccounts",function(){return t(2471)}])},5702:function(e,n,t){"use strict";t.d(n,{h:function(){return r}}),t(1752),t(1163);let a={get:c("GET"),post:c("POST"),put:c("PUT"),delete:c("DELETE")};function c(e){return async(n,t)=>{let a={method:e,headers:function(e){let n=JSON.parse(localStorage.getItem("user")),t=null==n?void 0:n.token;return t?{Authorization:"Bearer ".concat(n.token)}:{}}(0)};return t&&(a.headers["Content-Type"]="application/json",a.body=JSON.stringify(t)),fetch(n,a).then(s)}}async function s(e){var n,t;let a=null===(t=e.headers)||void 0===t?void 0:null===(n=t.get("content-type"))||void 0===n?void 0:n.includes("application/json");console.log("response :",e);let c=a?await e.json():null;console.log("data :",c);let s=JSON.parse(localStorage.getItem("user"));if(!e.ok){[401,403].includes(e.status)&&(null==s?void 0:s.token)&&r.logout();let n=c&&c.message||e.statusText;return Promise.reject(n)}return c}let o="/api",r={login:i,getCurrentUser:l,logout:function(){localStorage.removeItem("user")},register:u,updateBalance:d,getAll:h,getBankAccounts:j,createBankAccount:x};async function l(){return await JSON.parse(localStorage.getItem("user"))}async function i(e){let{email:n,password:t}=e,c=await a.post("".concat(o,"/account/login"),{email:n,password:t});return localStorage.setItem("user",JSON.stringify(c)),c}async function u(e){await a.post("".concat(o,"/account/register"),e)}async function d(e){let{email:n,amount:t}=e;return await a.post("".concat(o,"/updateBalance"),{email:n,amount:parseFloat(t)})}async function h(){return await a.get("".concat(o,"/account/all"))}async function j(e){let{email:n}=e;return await a.post("".concat(o,"/bankAccounts/get"),{email:n})}async function x(e){let{email:n,accountName:t}=e;return await a.post("".concat(o,"/bankAccounts/createAccount"),{email:n,accountName:t})}},2471:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var a=t(5893),c=t(7294),s=t(8837),o=t(9396),r=t(3680),l=t(1676);let i=e=>{let{show:n,onHide:t,accounts:s,onTransferMoney:i}=e,[u,d]=(0,c.useState)(0),[h,j]=(0,c.useState)(""),[x,m]=(0,c.useState)("");return(0,a.jsxs)(o.Z,{show:n,onHide:t,children:[(0,a.jsx)(o.Z.Header,{closeButton:!0,children:(0,a.jsx)(o.Z.Title,{children:"Transfer funds between accounts"})}),(0,a.jsx)(o.Z.Body,{children:(0,a.jsxs)(l.Z,{children:[(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Amount to transfer (€)"}),(0,a.jsx)(l.Z.Control,{type:"number",value:u,onChange:e=>d(parseFloat(e.target.value))})]}),(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Compte source"}),(0,a.jsxs)(l.Z.Select,{onChange:e=>j(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Choose account"}),s.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Target account"}),(0,a.jsxs)(l.Z.Select,{onChange:e=>m(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Choose account"}),s.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]})}),(0,a.jsxs)(o.Z.Footer,{children:[(0,a.jsx)(r.Z,{variant:"secondary",onClick:t,children:"Cancel"}),(0,a.jsx)(r.Z,{variant:"primary",onClick:()=>{let e=s.find(e=>e.name===h),n=s.find(e=>e.name===x);e&&n&&u>0&&e.balance>=u&&(e.balance-=u,n.balance+=u,t())},children:"Transfer"})]})]})};var u=e=>{let{accounts:n}=e,[t,s]=(0,c.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Z,{variant:"primary",className:"mt-3",onClick:()=>s(!0),children:"Transfer funds"}),t&&(0,a.jsx)(i,{accounts:n,show:t,onHide:()=>s(!1)})]})};let d=e=>{let{show:n,onHide:t,createAccount:s}=e,[i,u]=(0,c.useState)(""),d=e=>{e.preventDefault(),s({accountName:i})};return(0,a.jsxs)(o.Z,{show:n,onHide:t,children:[(0,a.jsx)(o.Z.Header,{closeButton:!0,children:(0,a.jsx)(o.Z.Title,{children:"Create a new bank account"})}),(0,a.jsx)(o.Z.Body,{children:(0,a.jsx)(l.Z,{onSubmit:d,children:(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Name of the account"}),(0,a.jsx)(l.Z.Control,{type:"text",value:i,onChange:e=>u(e.target.value)})]})})}),(0,a.jsxs)(o.Z.Footer,{children:[(0,a.jsx)(r.Z,{variant:"secondary",onClick:t,children:"Cancel"}),(0,a.jsx)(r.Z,{variant:"primary",onClick:d,children:"Create"})]})]})};var h=e=>{let{createAccount:n}=e,[t,s]=(0,c.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)(r.Z,{variant:"success",className:"mt-3",onClick:()=>s(!0),children:"Create a new account"}),t&&(0,a.jsx)(d,{show:t,onHide:()=>s(!1),createAccount:n})]})},j=t(5702),x=t(390);let m=e=>{let{account:n}=e;return(0,a.jsx)("div",{className:"col",children:(0,a.jsx)(s.Z,{children:(0,a.jsxs)(s.Z.Body,{children:[(0,a.jsx)(s.Z.Title,{children:n.name}),(0,a.jsxs)(s.Z.Text,{children:["Balance: ",n.balance," €"]})]})})})};var p=()=>{let[e,n]=c.useState(!1),{currentUser:t,setCurrentUser:s}=(0,x.Z)(),[o,r]=(0,c.useState)([{id:1,name:"Checking account",balance:1e3},{id:2,name:"Savings account",balance:5e3}]),[l,i]=(0,c.useState)(!1),[d,p]=(0,c.useState)(!1),[f,v]=(0,c.useState)(0),[Z,g]=(0,c.useState)(""),[S,C]=(0,c.useState)(""),[w,y]=(0,c.useState)("");return(0,c.useEffect)(()=>{n(!0)},[t]),(0,a.jsxs)("div",{className:"container mt-4",children:[(0,a.jsx)("h1",{children:"Comptes"}),(0,a.jsx)("div",{className:"row row-cols-1 row-cols-md-2 g-4",children:o.map((e,n)=>(0,a.jsx)(m,{account:e},n))}),(0,a.jsx)(u,{accounts:o}),(0,a.jsx)(h,{createAccount:e=>{let{accountName:n="Saving account"}=e;j.h.createBankAccount({email:null==t?void 0:t.email,accountName:n})}})]})}}},function(e){e.O(0,[200,774,888,179],function(){return e(e.s=5410)}),_N_E=e.O()}]);