(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[667],{1752:function(t,e,n){n(7905)},945:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Login",function(){return n(3918)}])},9143:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var s=n(5893);function a(t){return(0,s.jsxs)("div",{className:function(){let e=t.bgcolor?" bg-"+t.bgcolor:"",n=t.txtcolor?" text-"+t.txtcolor:" text-white";return"card mb-3"+e+n}(),style:{maxWidth:"18rem"},children:[t.img&&(0,s.jsx)("img",{src:t.img,alt:"Transmis du parent"}),(0,s.jsx)("div",{className:"card-header",children:t.header}),(0,s.jsxs)("div",{className:"card-body",children:[t.title&&(0,s.jsx)("h5",{className:"card-title",children:t.title}),t.text&&(0,s.jsx)("p",{className:"card-text",children:t.text}),t.body,t.status&&(0,s.jsx)("div",{id:"createStatus",children:t.status})]})]})}},5702:function(t,e,n){"use strict";n.d(e,{h:function(){return l}}),n(1752),n(1163);let s={get:a("GET"),post:a("POST"),put:a("PUT"),delete:a("DELETE")};function a(t){return async(e,n)=>{let s={method:t,headers:function(t){let e=JSON.parse(localStorage.getItem("user")),n=null==e?void 0:e.token;return n?{Authorization:"Bearer ".concat(e.token)}:{}}(0)};return n&&(s.headers["Content-Type"]="application/json",s.body=JSON.stringify(n)),fetch(e,s).then(o)}}async function o(t){var e,n;let s=null===(n=t.headers)||void 0===n?void 0:null===(e=n.get("content-type"))||void 0===e?void 0:e.includes("application/json");console.log("response :",t);let a=s?await t.json():null;console.log("data :",a);let o=JSON.parse(localStorage.getItem("user"));if(!t.ok){[401,403].includes(t.status)&&(null==o?void 0:o.token)&&l.logout();let e=a&&a.message||t.statusText;return Promise.reject(e)}return a}let r="/api",l={login:i,getCurrentUser:c,logout:function(){localStorage.removeItem("user")},register:u,updateBalance:d,getAll:h,getBankAccounts:g,createBankAccount:m};async function c(){return await JSON.parse(localStorage.getItem("user"))}async function i(t){let{email:e,password:n}=t,a=await s.post("".concat(r,"/account/login"),{email:e,password:n});return localStorage.setItem("user",JSON.stringify(a)),a}async function u(t){await s.post("".concat(r,"/account/register"),t)}async function d(t){let{email:e,amount:n}=t;return await s.post("".concat(r,"/updateBalance"),{email:e,amount:parseFloat(n)})}async function h(){return await s.get("".concat(r,"/account/all"))}async function g(t){let{email:e}=t;return await s.post("".concat(r,"/bankAccounts/get"),{email:e})}async function m(t){let{email:e,accountName:n}=t;return await s.post("".concat(r,"/bankAccounts/createAccount"),{email:e,accountName:n})}},3918:function(t,e,n){"use strict";n.r(e);var s=n(5893),a=n(7294),o=n(9143),r=n(390),l=n(5702);function c(t){let{currentUser:e,setCurrentUser:n}=(0,r.Z)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h5",{children:["Logged in as ",null==e?void 0:e.name]}),(0,s.jsxs)("p",{children:["With email: ",null==e?void 0:e.email]}),(0,s.jsx)("button",{type:"submit",className:"btn btn-light",onClick:()=>{n(null),t.setShowLoginForm(!0),l.h.logout()},children:"Logout"})]})}function i(t){let[e,n]=a.useState(!1),[o,c]=a.useState(""),[i,u]=a.useState(""),[d,h]=a.useState(!1),[g,m]=a.useState(!0),{currentUser:p,setCurrentUser:f}=(0,r.Z)();console.log("currentUser : ",p),a.useEffect(()=>{m((null==o?void 0:o.length)>0&&(null==i?void 0:i.length)>0)},[o,i]);let x=async e=>{e.preventDefault(),n(!0),await l.h.login({email:o,password:i}).then(e=>{f(e),t.setShowLoginForm(!1)}).catch(e=>{console.error("error :",e),t.setErrorMessage(e),setTimeout(()=>t.setErrorMessage(""),2e3)}).finally(()=>n(!1))};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("form",{onSubmit:x,children:[(0,s.jsxs)("label",{children:["Email",(0,s.jsx)("input",{type:"input",className:"form-control",placeholder:"Enter email",value:o,onChange:t=>c(t.currentTarget.value)})]}),(0,s.jsxs)("label",{children:["Password",(0,s.jsx)("input",{type:d?"text":"password",className:"form-control",placeholder:"Enter password",value:i,onChange:t=>u(t.currentTarget.value)})]}),(0,s.jsxs)("label",{htmlFor:"showPassword",children:[(0,s.jsx)("input",{type:"checkbox",id:"showPassword",onClick:()=>h(!d)})," Show Password"]}),(0,s.jsx)("br",{}),(0,s.jsx)("input",{disabled:!g,className:"btn btn-light",type:"submit"}),e&&(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsx)("div",{className:"spinner-border",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})})}e.default=function(){let[t,e]=a.useState(!0),[n,l]=a.useState(""),[u,d]=a.useState(""),{currentUser:h,setCurrentUser:g}=(0,r.Z)();return(0,a.useEffect)(()=>{null===h?e(!0):e(!1)},[h]),(0,s.jsx)(o.Z,{bgcolor:"secondary",header:"Login",status:n,body:(0,s.jsxs)(s.Fragment,{children:[t?(0,s.jsx)(i,{setShowLoginForm:e,setStatus:l,setErrorMessage:d}):(0,s.jsx)(c,{setShowLoginForm:e,setStatus:l}),(0,s.jsx)("span",{className:"text-danger",children:u||""})]})})}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=945)}),_N_E=t.O()}]);