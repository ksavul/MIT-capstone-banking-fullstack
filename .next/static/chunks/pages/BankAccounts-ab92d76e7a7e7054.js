(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73],{5410:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/BankAccounts",function(){return n(2471)}])},5702:function(e,t,n){"use strict";n.d(t,{h:function(){return o}}),n(1752),n(1163);let a={get:c("GET"),post:c("POST"),put:c("PUT"),delete:c("DELETE")};function c(e){return async(t,n)=>{let a={method:e,headers:function(e){let t=JSON.parse(localStorage.getItem("user")),n=null==t?void 0:t.token;return n?{Authorization:"Bearer ".concat(t.token)}:{}}(0)};return n&&(a.headers["Content-Type"]="application/json",a.body=JSON.stringify(n)),fetch(t,a).then(s)}}async function s(e){var t,n;let a=null===(n=e.headers)||void 0===n?void 0:null===(t=n.get("content-type"))||void 0===t?void 0:t.includes("application/json");console.log("response :",e);let c=a?await e.json():null;console.log("data :",c);let s=JSON.parse(localStorage.getItem("user"));if(!e.ok){[401,403].includes(e.status)&&(null==s?void 0:s.token)&&o.logout();let t=c&&c.message||e.statusText;return Promise.reject(t)}return c}let r="/api",o={login:i,getCurrentUser:l,logout:function(){localStorage.removeItem("user")},register:u,updateBalance:d,getAll:h,getBankAccounts:m,createBankAccount:j};async function l(){return await JSON.parse(localStorage.getItem("user"))}async function i(e){let{email:t,password:n}=e,c=await a.post("".concat(r,"/account/login"),{email:t,password:n});return localStorage.setItem("user",JSON.stringify(c)),c}async function u(e){await a.post("".concat(r,"/account/register"),e)}async function d(e){let{email:t,amount:n}=e;return await a.post("".concat(r,"/updateBalance"),{email:t,amount:parseFloat(n)})}async function h(){return await a.get("".concat(r,"/account/all"))}async function m(e){let{email:t}=e;return await a.post("".concat(r,"/bankAccounts/get"),{email:t})}async function j(e){let{email:t,accountName:n}=e;return await a.post("".concat(r,"/bankAccounts/createAccount"),{email:t,accountName:n})}},2471:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return p}});var a=n(5893),c=n(7294),s=n(8837),r=n(9396),o=n(3680),l=n(1676);let i=e=>{let{show:t,onHide:n,accounts:s,onTransferMoney:i}=e,[u,d]=(0,c.useState)(0),[h,m]=(0,c.useState)(""),[j,x]=(0,c.useState)("");return(0,a.jsxs)(r.Z,{show:t,onHide:n,children:[(0,a.jsx)(r.Z.Header,{closeButton:!0,children:(0,a.jsx)(r.Z.Title,{children:"Transfer funds between accounts"})}),(0,a.jsx)(r.Z.Body,{children:(0,a.jsxs)(l.Z,{children:[(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Amount to transfer (€)"}),(0,a.jsx)(l.Z.Control,{type:"number",value:u,onChange:e=>d(parseFloat(e.target.value))})]}),(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Compte source"}),(0,a.jsxs)(l.Z.Select,{onChange:e=>m(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Choisir un compte"}),s.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Target account"}),(0,a.jsxs)(l.Z.Select,{onChange:e=>x(e.target.value),children:[(0,a.jsx)("option",{value:"",children:"Choose account"}),s.map(e=>(0,a.jsx)("option",{value:e.name,children:e.name},e.id))]})]})]})}),(0,a.jsxs)(r.Z.Footer,{children:[(0,a.jsx)(o.Z,{variant:"secondary",onClick:n,children:"Cancel"}),(0,a.jsx)(o.Z,{variant:"primary",onClick:()=>{let e=s.find(e=>e.name===h),t=s.find(e=>e.name===j);e&&t&&u>0&&e.balance>=u&&(e.balance-=u,t.balance+=u,n())},children:"Transfer"})]})]})};var u=e=>{let{accounts:t}=e,[n,s]=(0,c.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Z,{variant:"primary",className:"mt-3",onClick:()=>s(!0),children:"Transfer funds"}),n&&(0,a.jsx)(i,{accounts:t,show:n,onHide:()=>s(!1)})]})};let d=e=>{let{show:t,onHide:n,createAccount:s}=e,[i,u]=(0,c.useState)(""),d=e=>{e.preventDefault(),s({accountName:i})};return(0,a.jsxs)(r.Z,{show:t,onHide:n,children:[(0,a.jsx)(r.Z.Header,{closeButton:!0,children:(0,a.jsx)(r.Z.Title,{children:"Create a new bank account"})}),(0,a.jsx)(r.Z.Body,{children:(0,a.jsx)(l.Z,{onSubmit:d,children:(0,a.jsxs)(l.Z.Group,{className:"mb-3",children:[(0,a.jsx)(l.Z.Label,{children:"Name of the account"}),(0,a.jsx)(l.Z.Control,{type:"text",value:i,onChange:e=>u(e.target.value)})]})})}),(0,a.jsxs)(r.Z.Footer,{children:[(0,a.jsx)(o.Z,{variant:"secondary",onClick:n,children:"Cancel"}),(0,a.jsx)(o.Z,{variant:"primary",onClick:d,children:"Create"})]})]})};var h=e=>{let{createAccount:t}=e,[n,s]=(0,c.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)(o.Z,{variant:"success",className:"mt-3",onClick:()=>s(!0),children:"Create a new account"}),n&&(0,a.jsx)(d,{show:n,onHide:()=>s(!1),createAccount:t})]})},m=n(5702),j=n(390);let x=e=>{let{account:t}=e;return(0,a.jsx)("div",{className:"col",children:(0,a.jsx)(s.Z,{children:(0,a.jsxs)(s.Z.Body,{children:[(0,a.jsx)(s.Z.Title,{children:t.name}),(0,a.jsxs)(s.Z.Text,{children:["Balance: ",t.balance," €"]})]})})})};var p=()=>{let[e,t]=c.useState(!1),{currentUser:n,setCurrentUser:s}=(0,j.Z)(),[r,o]=(0,c.useState)([{id:1,name:"Compte courant",balance:1e3},{id:2,name:"Compte d'\xe9pargne",balance:5e3}]),[l,i]=(0,c.useState)(!1),[d,p]=(0,c.useState)(!1),[f,v]=(0,c.useState)(0),[Z,g]=(0,c.useState)(""),[S,C]=(0,c.useState)(""),[w,y]=(0,c.useState)("");return(0,c.useEffect)(()=>{t(!0)},[n]),(0,a.jsxs)("div",{className:"container mt-4",children:[(0,a.jsx)("h1",{children:"Comptes"}),(0,a.jsx)("div",{className:"row row-cols-1 row-cols-md-2 g-4",children:r.map((e,t)=>(0,a.jsx)(x,{account:e},t))}),(0,a.jsx)(u,{accounts:r}),(0,a.jsx)(h,{createAccount:e=>{let{accountName:t="Saving account"}=e;m.h.createBankAccount({email:null==n?void 0:n.email,accountName:t})}})]})}}},function(e){e.O(0,[200,774,888,179],function(){return e(e.s=5410)}),_N_E=e.O()}]);