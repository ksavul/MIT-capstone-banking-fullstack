(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{1752:function(t,e,n){n(7905)},3618:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Deposit",function(){return n(7589)}])},9143:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var s=n(5893);function a(t){return(0,s.jsxs)("div",{className:function(){let e=t.bgcolor?" bg-"+t.bgcolor:"",n=t.txtcolor?" text-"+t.txtcolor:" text-white";return"card mb-3"+e+n}(),style:{maxWidth:"18rem"},children:[t.img&&(0,s.jsx)("img",{src:t.img,alt:"Transmis du parent"}),(0,s.jsx)("div",{className:"card-header",children:t.header}),(0,s.jsxs)("div",{className:"card-body",children:[t.title&&(0,s.jsx)("h5",{className:"card-title",children:t.title}),t.text&&(0,s.jsx)("p",{className:"card-text",children:t.text}),t.body,t.status&&(0,s.jsx)("div",{id:"createStatus",children:t.status})]})]})}},5702:function(t,e,n){"use strict";n.d(e,{h:function(){return o}}),n(1752),n(1163);let s={get:a("GET"),post:a("POST"),put:a("PUT"),delete:a("DELETE")};function a(t){return async(e,n)=>{let s={method:t,headers:function(t){let e=JSON.parse(localStorage.getItem("user")),n=null==e?void 0:e.token;return n?{Authorization:"Bearer ".concat(e.token)}:{}}(0)};return n&&(s.headers["Content-Type"]="application/json",s.body=JSON.stringify(n)),fetch(e,s).then(r)}}async function r(t){var e,n;let s=null===(n=t.headers)||void 0===n?void 0:null===(e=n.get("content-type"))||void 0===e?void 0:e.includes("application/json");console.log("response :",t);let a=s?await t.json():null;console.log("data :",a);let r=JSON.parse(localStorage.getItem("user"));if(!t.ok){[401,403].includes(t.status)&&(null==r?void 0:r.token)&&o.logout();let e=a&&a.message||t.statusText;return Promise.reject(e)}return a}let c="/api",o={login:i,getCurrentUser:l,logout:function(){localStorage.removeItem("user")},register:u,updateBalance:d,getAll:h,getBankAccounts:m,createBankAccount:g};async function l(){return await JSON.parse(localStorage.getItem("user"))}async function i(t){let{email:e,password:n}=t,a=await s.post("".concat(c,"/account/login"),{email:e,password:n});return localStorage.setItem("user",JSON.stringify(a)),a}async function u(t){await s.post("".concat(c,"/account/register"),t)}async function d(t){let{email:e,amount:n}=t;return await s.post("".concat(c,"/updateBalance"),{email:e,amount:parseFloat(n)})}async function h(){return await s.get("".concat(c,"/account/all"))}async function m(t){let{email:e}=t;return await s.post("".concat(c,"/bankAccounts/get"),{email:e})}async function g(t){let{email:e,accountName:n}=t;return await s.post("".concat(c,"/bankAccounts/createAccount"),{email:e,accountName:n})}},7589:function(t,e,n){"use strict";n.r(e);var s=n(5893),a=n(7294),r=n(9143),c=n(1664),o=n.n(c),l=n(390),i=n(5702);let u=t=>{let{message:e,setStatus:n}=t;n(e),setTimeout(()=>n(""),2e3)},d=t=>{let[e,n]=a.useState(!1),[r,c]=a.useState(null),{currentUser:o,setCurrentUser:d}=(0,l.Z)();async function h(e){var s;if(e.preventDefault(),n(!0),r<1){u({message:"Number can't be negative",setStatus:t.setErrorMessage});return}await (null===(s=i.h)||void 0===s?void 0:s.updateBalance({email:o.email,amount:r}).then(e=>{u({message:"$".concat(r," deposit successful!"),setStatus:t.setStatus}),d({...e,token:o.token}),setTimeout(()=>null==t?void 0:t.setStatus(""),2e3),c(null)}).catch(t=>console.error("DESPOSIT ERROR - ",t)).finally(()=>n(!1)))}return(0,s.jsxs)("form",{onSubmit:h,children:[(0,s.jsxs)("label",{children:["Enter amount to deposit:",(0,s.jsx)("input",{type:"number",name:"number",className:"form-control",required:!0,value:r||"",onChange:t=>c(t.currentTarget.value)})]}),(0,s.jsx)("input",{disabled:!((null==r?void 0:r.length)>0),className:"btn btn-light my-3",type:"submit"}),e&&(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsx)("div",{className:"spinner-border",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"Loading..."})})})]})};e.default=function(){let{currentUser:t,setCurrentUser:e}=(0,l.Z)(),[n,c]=(0,a.useState)(0),[i,u]=a.useState(!0),[h,m]=a.useState("");return(0,s.jsx)(r.Z,{bgcolor:"success",header:"Deposit",text:"",status:i,body:(0,s.jsx)(s.Fragment,{children:t?(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"text-dark ",children:["Balance :",(0,s.jsxs)("span",{className:"font-weight-bold",children:[" ",null==t?void 0:t.balance,"$"]})]}),(0,s.jsx)(d,{setStatus:u,setErrorMessage:m}),(0,s.jsx)("span",{className:"text-danger",children:h||""})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{children:"You need to login first"}),(0,s.jsx)(o(),{href:"/Login",className:"btn btn-light",children:"Login"})]})})})}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=3618)}),_N_E=t.O()}]);